![TigerGraph Logo](https://www.tigergraph.com/wp-content/uploads/2020/05/TG_LOGO.svg) [Docs](https://docs.tigergraph.com/home)
Page 1[Prev](https://docs.tigergraph.com/home/alerts/cve-2022-30331)[Next](https://docs.tigergraph.com/home/alerts/cve-2022-30331)
Search by [Algolia](https://www.algolia.com/docsearch)
[Products](https://docs.tigergraph.com/home/alerts/cve-2022-30331)
TigerGraph Savanna
[TigerGraph Savanna](https://docs.tigergraph.com/savanna/main/overview/) [(_TigerGraph Cloud Classic_)](https://docs.tigergraph.com/cloud/main/start/overview)
TigerGraph Server
[TigerGraph DB](https://docs.tigergraph.com/tigergraph-server/4.2/intro/)
TigerGraph Suite
[GraphStudio and Admin Portal](https://docs.tigergraph.com/gui/4.2/intro/) [Insights](https://docs.tigergraph.com/insights/4.2/intro/) [GSQL Web Shell](https://docs.tigergraph.com/tigergraph-server/current/gsql-shell/web)
Query Languages
[GSQL Language Reference](https://docs.tigergraph.com/gsql-ref/4.2/intro/) [GSQL Web Shell](https://docs.tigergraph.com/tigergraph-server/current/gsql-shell/web) [OpenCypher](https://docs.tigergraph.com/gsql-ref/current/opencypher-in-gsql)
AI & Graph Intelligence
[Graph Data Science Library](https://docs.tigergraph.com/graph-ml/3.10/intro/) [Hybrid Graph+Vector Search](https://docs.tigergraph.com/gsql-ref/current/vector/)
Connectors and APIs
[Data Connectors](https://docs.tigergraph.com/tigergraph-server/current/data-loading) [pyTigerGraph](https://docs.tigergraph.com/pytigergraph/1.8/intro/) [TigerGraph GraphQL Service](https://docs.tigergraph.com/graphql/3.9/) [JDBC Driver](https://github.com/tigergraph/ecosys/tree/master/tools/etl/tg-jdbc-driver)
Legacy Documentation
[ Legacy Documentation ](https://docs-legacy.tigergraph.com)
[Resources](https://docs.tigergraph.com/home/alerts/cve-2022-30331)
[Developer Site](https://dev.tigergraph.com/) [Community Forum](https://community.tigergraph.com/) [Knowledge Base](https://tigergraph.freshdesk.com/support/solutions)
[Download](https://dl.tigergraph.com)
[ TG Savanna](https://savanna.tgcloud.io)
Explore
[Fully-Managed: Savanna](https://docs.tigergraph.com/savanna/main/overview/)
[Self-Managed: TigerGraph DB](https://docs.tigergraph.com/tigergraph-server/4.2/intro/)
[Install](https://docs.tigergraph.com/tigergraph-server/current/getting-started/) [Manage](https://docs.tigergraph.com/tigergraph-server/current/system-management/)
Tutorials & Guides
[GSQL](https://github.com/tigergraph/ecosys/blob/master/tutorials/GSQL.md) [OpenCypher in GSQL](https://github.com/tigergraph/ecosys/blob/master/tutorials/Cypher.md) [Hybrid Vector Search](https://github.com/tigergraph/ecosys/blob/master/tutorials/VectorSearch.md)
Reference Manuals
[GSQL](https://docs.tigergraph.com/gsql-ref/4.2/intro/) [OpenCypher](https://docs.tigergraph.com/gsql-ref/current/opencypher-in-gsql/) [Vector](https://docs.tigergraph.com/gsql-ref/current/vector/) [REST APIs](https://docs.tigergraph.com/tigergraph-server/current/api/) [Configuration Parameters](https://docs.tigergraph.com/tigergraph-server/current/reference/configuration-parameters)
Visual Tools
[Develop: GraphStudio](https://docs.tigergraph.com/gui/4.2/intro/) [Administer: Admin Portal](https://docs.tigergraph.com/gui/4.2/intro/) [Visualize: Insights](https://docs.tigergraph.com/insights/4.2/intro/)
AI & Data Science
[Graph Algorithms](https://docs.tigergraph.com/graph-ml/3.10/intro/) [pyTigerGraph](https://docs.tigergraph.com/pytigergraph/1.8/intro/) [TigerGraphX](https://github.com/tigergraph/ecosys/blob/master/tutorials/TigerGraphX.md) [ML Workbench](https://docs.tigergraph.com/ml-workbench/1.4/intro/) [CoPilot](https://docs.tigergraph.com/tg-copilot/intro/)
  * [TigerGraph DB](https://docs.tigergraph.com/tigergraph-server/4.2/intro/)
    * [4.2 Pre](https://docs.tigergraph.com/tigergraph-server/4.2/intro/)
    * [4.1](https://docs.tigergraph.com/tigergraph-server/4.1/intro/)
    * [3.11](https://docs.tigergraph.com/tigergraph-server/3.11/intro/)
    * [3.10](https://docs.tigergraph.com/tigergraph-server/3.10/intro/)
    * [3.9](https://docs.tigergraph.com/tigergraph-server/3.9/intro/)
    * [3.6](https://docs.tigergraph.com/tigergraph-server/3.6/intro/)
  * [GSQL Language Reference](https://docs.tigergraph.com/gsql-ref/4.2/intro/)
    * [4.2 Pre](https://docs.tigergraph.com/gsql-ref/4.2/intro/)
    * [4.1](https://docs.tigergraph.com/gsql-ref/4.1/intro/)
    * [3.11](https://docs.tigergraph.com/gsql-ref/3.11/intro/)
    * [3.10](https://docs.tigergraph.com/gsql-ref/3.10/intro/)
    * [3.9](https://docs.tigergraph.com/gsql-ref/3.9/intro/)
    * [3.6](https://docs.tigergraph.com/gsql-ref/3.6/intro/intro)
  * [TigerGraph Savanna](https://docs.tigergraph.com/savanna/main/overview/)
  * [GraphStudio and Admin Portal](https://docs.tigergraph.com/gui/4.2/intro/)
    * [4.2 Pre](https://docs.tigergraph.com/gui/4.2/intro/)
    * [4.1](https://docs.tigergraph.com/gui/4.1/intro/)
    * [3.11](https://docs.tigergraph.com/gui/3.11/intro/)
    * [3.10](https://docs.tigergraph.com/gui/3.10/intro/)
    * [3.9](https://docs.tigergraph.com/gui/3.9/intro/)
    * [3.6](https://docs.tigergraph.com/gui/3.6/graphstudio/overview)
  * [Insights](https://docs.tigergraph.com/insights/4.2/intro/)
    * [4.2 Pre](https://docs.tigergraph.com/insights/4.2/intro/)
    * [4.1](https://docs.tigergraph.com/insights/4.1/intro/)
    * [3.11](https://docs.tigergraph.com/insights/3.11/intro/)
    * [3.10](https://docs.tigergraph.com/insights/3.10/intro/)
    * [3.9](https://docs.tigergraph.com/insights/3.9/intro/)
  * [Graph Data Science Library](https://docs.tigergraph.com/graph-ml/3.10/intro/)
    * [3.10](https://docs.tigergraph.com/graph-ml/3.10/intro/)
  * [pyTigerGraph](https://docs.tigergraph.com/pytigergraph/1.8/intro/)
    * [1.8](https://docs.tigergraph.com/pytigergraph/1.8/intro/)
    * [1.7](https://docs.tigergraph.com/pytigergraph/1.7/intro/)
    * [1.6](https://docs.tigergraph.com/pytigergraph/1.6/intro/)
  * [TigerGraph ML Workbench](https://docs.tigergraph.com/ml-workbench/1.4/intro/)
    * [1.4](https://docs.tigergraph.com/ml-workbench/1.4/intro/)
  * [TigerGraph GraphQL Service](https://docs.tigergraph.com/graphql/3.9/)
    * [3.9](https://docs.tigergraph.com/graphql/3.9/)
  * [TigerGraph CoPilot](https://docs.tigergraph.com/tg-copilot/intro/)
    * [main](https://docs.tigergraph.com/tg-copilot/intro/)
  * [TigerGraph Cloud Classic](https://docs.tigergraph.com/cloud/main/start/overview)


[](https://docs.tigergraph.com/home/)
[Edit this Page](https://github.com/tigergraph/doc-site/edit/main/home/modules/alerts/pages/cve-2022-30331.adoc)
### Contents
  * [Background](https://docs.tigergraph.com/home/alerts/cve-2022-30331#_background)
  * [Root causes](https://docs.tigergraph.com/home/alerts/cve-2022-30331#_root_causes)
  * [Best practices to secure your deployment](https://docs.tigergraph.com/home/alerts/cve-2022-30331#_best_practices_to_secure_your_deployment)
  * [Remediations](https://docs.tigergraph.com/home/alerts/cve-2022-30331#_remediations)
  * [Blocking UDF Uploading (v3.8.0+)](https://docs.tigergraph.com/home/alerts/cve-2022-30331#_blocking_udf_uploading_v3_8_0)
  * [UDF File Scanning (v3.9.0+)](https://docs.tigergraph.com/home/alerts/cve-2022-30331#_udf_file_scanning_v3_9_0)


# Alert for CVE-2022-30331
### Contents
  * [Background](https://docs.tigergraph.com/home/alerts/cve-2022-30331#_background)
  * [Root causes](https://docs.tigergraph.com/home/alerts/cve-2022-30331#_root_causes)
  * [Best practices to secure your deployment](https://docs.tigergraph.com/home/alerts/cve-2022-30331#_best_practices_to_secure_your_deployment)
  * [Remediations](https://docs.tigergraph.com/home/alerts/cve-2022-30331#_remediations)
  * [Blocking UDF Uploading (v3.8.0+)](https://docs.tigergraph.com/home/alerts/cve-2022-30331#_blocking_udf_uploading_v3_8_0)
  * [UDF File Scanning (v3.9.0+)](https://docs.tigergraph.com/home/alerts/cve-2022-30331#_udf_file_scanning_v3_9_0)


Type: Security
Original date: June 2022
In May 2022, [CVE-2022-30331](https://nvd.nist.gov/vuln/detail/CVE-2022-30331) was filed as a vulnerability with an 8.8 severity score affecting TigerGraph’s [User-Defined Functions (UDF) feature](https://docs.tigergraph.com/gsql-ref/4.2/querying/func/query-user-defined-functions).
**TigerGraph has disputed this vulnerability** , as the basis of the claim merely states that a privileged user could write code within TigerGraph that might introduce a vulnerability in a query accessible to other authenticated users.
## [](https://docs.tigergraph.com/home/alerts/cve-2022-30331#_background)Background
One of the key benefits of using TigerGraph is the ability to create custom functions (UDFs) in native C++ for high-speed data-manipulation. These functions are then made available to all users for implementation in their query operations. As C++ is a powerful, low-level programming language, it is expected that anyone who writes or installs code is familiar with secure coding practices and careful to review any code from outside sources before implementation. By default, only users with the `superuser` role are allowed access to install UDFs, ensuring that any code installed is properly reviewed by an administrator at the appropriate level. Configuration controls are also available to ensure UDFs are pulled from a trusted administrator repository if the feature to store UDFs on GitHub is leveraged.
The remainder of the CVE details various malicious actions leveraging the custom C++ code in the UDF. None of these actions are possible with the proper superuser password configured and review of code by the superuser.
## [](https://docs.tigergraph.com/home/alerts/cve-2022-30331#_root_causes)Root causes
These are the root causes of the exploitation detailed in the CVE:
  * The default superuser did not configure their password to enable authentication.
  * The superuser installed malicious/insecure code which allowed any user to execute a shell command.


## [](https://docs.tigergraph.com/home/alerts/cve-2022-30331#_best_practices_to_secure_your_deployment)Best practices to secure your deployment
The following best practices should always be followed to ensure your environment is secured:
  * Credentials should be properly configured. Default credentials/passwords is #5 in [the OWASP Top 10 list of vulnerabilities](https://owasp.org/Top10/A05_2021-Security_Misconfiguration/).
  * By default, only [superusers](https://docs.tigergraph.com/tigergraph-server/4.2/user-access/access-control-model#_roles) have [the `WRITE_FILE` privilege](https://docs.tigergraph.com/tigergraph-server/4.2/user-access/access-control-model#_privileges), which permits the installation of UDFs. Only users trusted to review and install custom code should be given this privilege.
  * Superusers should treat UDFs as developed software. We recommend utilizing the Secure Software Development Life Cycle processes, including static code analysis and appropriate code reviews, prior to installing them on a TigerGraph deployment.
  * If GSQL is configured to [read from a GitHub repository for UDFs](https://docs.tigergraph.com/gsql-ref/4.2/querying/func/query-user-defined-functions#_use_github_to_store_udfs), ensure that the repository is properly secured, and the hosted code and any future changes are reviewed by system administrators prior to installing them on a TigerGraph deployment.


## [](https://docs.tigergraph.com/home/alerts/cve-2022-30331#_remediations)Remediations
### [](https://docs.tigergraph.com/home/alerts/cve-2022-30331#_blocking_udf_uploading_v3_8_0)Blocking UDF Uploading (v3.8.0+)
There are two possible ways for a user to upload a UDF. Starting with TigerGraph 3.8.0, both of those methods are disabled by default. Each of them can only be enabled by a user with administrator privilege using the `gadmin` command. For more details, see [Upload UDFs](https://docs.tigergraph.com/gsql-ref/4.2/querying/func/query-user-defined-functions#_upload_udfs).
### [](https://docs.tigergraph.com/home/alerts/cve-2022-30331#_udf_file_scanning_v3_9_0)UDF File Scanning (v3.9.0+)
TigerGraph 3.9.0 introduced a set of checks and restrictions, collectively known as UDF File Scanning, which block certain C++ code from being loaded. This feature, enabled by default, scans the UDF source code to ensure that each UDF complies with the security policies. UDFs which do not satisfy all the restrictions are blocked from being compiled and run. For full details, see TigerGraph documentation for [UDF file scanning](https://docs.tigergraph.com/tigergraph-server/4.2/security/#_udf_file_scanning).
  * **Feature blocklist**. C++ headers and features in this private, non-modifiable list are blocked from use.
  * **File header allowlist**. Only headers present in the allowlist can be included in UDF files. The default list (see [UDF file scanning](https://docs.tigergraph.com/tigergraph-server/4.2/security/#_udf_file_scanning)) can only be modified with a `gadmin config set` command by the system administrator.
  * **Macros with replacement** are disabled.


The security of your data is paramount to us, and we are continually looking for ways to improve our product to make sure it stays safe.
3 Twin Dolphin Drive, Ste 225 Redwood City, CA 94065 
Copyright © 2025 TigerGraph
  * ## Resources
    * [Support](https://www.tigergraph.com/support/)
    * [Community](https://community.tigergraph.com/)
    * [Developer Site](https://dev.tigergraph.com/)
    * [Test Drive](https://testdrive.tigergraph.com/)
  * ## Social
    * [Linkedin](https://www.linkedin.com/company/tigergraph/)
    * [Facebook](https://www.facebook.com/TigerGraphDB/)
    * [Twitter](https://twitter.com/tigergraphdb)
  * ## Legal
    * [Privacy Policy](https://www.tigergraph.com/privacy-policy/)
    * [Terms of Use](https://www.tigergraph.com/terms/)
    * [Sitemap](https://docs.tigergraph.com/sitemap.xml)


